<!DOCTYPE html>
<html>
<head>
<title>The Great Escape: Routine at AC6F</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../TheGreatEscape.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="ABF9.html">ABF9</a></span></td>
<td class="up">Up: <a href="../maps/all.html#ac6f">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="ACFC.html">ACFC</a></span></td>
</tr>
</table>
<div class="description">AC6F: Draw zoombox border.</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="ABA0.html">ABA0</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="ac6f"></span>AC6F</td>
<td class="instruction">LD A,($AB68)</td>
<td class="comment-11" rowspan="15">HL = game_window_start_addresses[(zoombox_y - 1) * 8]; // ie. * 16</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac72"></span>AC72</td>
<td class="instruction">DEC A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac73"></span>AC73</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac74"></span>AC74</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac75"></span>AC75</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac76"></span>AC76</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac77"></span>AC77</td>
<td class="instruction">LD HL,$EDD3</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac7a"></span>AC7A</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac7b"></span>AC7B</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac7c"></span>AC7C</td>
<td class="instruction">JR NC,$AC7F</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac7e"></span>AC7E</td>
<td class="instruction">INC H</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="ac7f"></span>AC7F</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac80"></span>AC80</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac81"></span>AC81</td>
<td class="instruction">LD H,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac82"></span>AC82</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="ac83"></span>
<div class="comments">
<div class="paragraph">
Top left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac83"></span>AC83</td>
<td class="instruction">LD A,($AB66)</td>
<td class="comment-11" rowspan="4">HL += zoombox_x - 1;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac86"></span>AC86</td>
<td class="instruction">DEC A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac87"></span>AC87</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac88"></span>AC88</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac89"></span>AC89</td>
<td class="instruction">LD A,$00</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_TL);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac8b"></span>AC8B</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac8e"></span>AC8E</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">HL++;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="ac8f"></span>
<div class="comments">
<div class="paragraph">
Horizontal, moving right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac8f"></span>AC8F</td>
<td class="instruction">LD A,($AB67)</td>
<td class="comment-11" rowspan="2">B = zoombox_horizontal_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac92"></span>AC92</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="ac93"></span>AC93</td>
<td class="instruction">LD A,$01</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_HZ);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac95"></span>AC95</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac98"></span>AC98</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">HL++;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac99"></span>AC99</td>
<td class="instruction">DJNZ $AC93</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="ac9b"></span>
<div class="comments">
<div class="paragraph">
Top right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac9b"></span>AC9B</td>
<td class="instruction">LD A,$02</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_TR);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ac9d"></span>AC9D</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aca0"></span>ACA0</td>
<td class="instruction">LD DE,$0020</td>
<td class="comment-11" rowspan="1">DE = 32;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aca3"></span>ACA3</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &gt;= 224) D = 0x07;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aca4"></span>ACA4</td>
<td class="instruction">CP $E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aca6"></span>ACA6</td>
<td class="instruction">JR C,$ACAA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aca8"></span>ACA8</td>
<td class="instruction">LD D,$07</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="acaa"></span>ACAA</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="acab"></span>
<div class="comments">
<div class="paragraph">
Vertical, moving down.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acab"></span>ACAB</td>
<td class="instruction">LD A,($AB69)</td>
<td class="comment-11" rowspan="2">B = zoombox_vertical_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acae"></span>ACAE</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="acaf"></span>ACAF</td>
<td class="instruction">LD A,$03</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_VT);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acb1"></span>ACB1</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acb4"></span>ACB4</td>
<td class="instruction">LD DE,$0020</td>
<td class="comment-11" rowspan="1">DE = 32;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acb7"></span>ACB7</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &gt;= 224) D = 0x07;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acb8"></span>ACB8</td>
<td class="instruction">CP $E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acba"></span>ACBA</td>
<td class="instruction">JR C,$ACBE</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acbc"></span>ACBC</td>
<td class="instruction">LD D,$07</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="acbe"></span>ACBE</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acbf"></span>ACBF</td>
<td class="instruction">DJNZ $ACAF</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="acc1"></span>
<div class="comments">
<div class="paragraph">
Bottom right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acc1"></span>ACC1</td>
<td class="instruction">LD A,$04</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_BR);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acc3"></span>ACC3</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acc6"></span>ACC6</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">HL--;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="acc7"></span>
<div class="comments">
<div class="paragraph">
Horizontal, moving left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acc7"></span>ACC7</td>
<td class="instruction">LD A,($AB67)</td>
<td class="comment-11" rowspan="2">B = zoombox_horizontal_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acca"></span>ACCA</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="accb"></span>ACCB</td>
<td class="instruction">LD A,$01</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_HZ);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="accd"></span>ACCD</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acd0"></span>ACD0</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">HL--;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acd1"></span>ACD1</td>
<td class="instruction">DJNZ $ACCB</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="acd3"></span>
<div class="comments">
<div class="paragraph">
Bottom left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acd3"></span>ACD3</td>
<td class="instruction">LD A,$05</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_BL);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acd5"></span>ACD5</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acd8"></span>ACD8</td>
<td class="instruction">LD DE,$FFE0</td>
<td class="comment-11" rowspan="1">DE = 0xFFE0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acdb"></span>ACDB</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &lt; 32) DE = 0xF8E0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acdc"></span>ACDC</td>
<td class="instruction">CP $20</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acde"></span>ACDE</td>
<td class="instruction">JR NC,$ACE3</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ace0"></span>ACE0</td>
<td class="instruction">LD DE,$F8E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="ace3"></span>ACE3</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="ace4"></span>
<div class="comments">
<div class="paragraph">
Vertical, moving up.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ace4"></span>ACE4</td>
<td class="instruction">LD A,($AB69)</td>
<td class="comment-11" rowspan="2">B = zoombox_vertical_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="ace7"></span>ACE7</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="ace8"></span>ACE8</td>
<td class="instruction">LD A,$03</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_VT);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acea"></span>ACEA</td>
<td class="instruction">CALL <a href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="aced"></span>ACED</td>
<td class="instruction">LD DE,$FFE0</td>
<td class="comment-11" rowspan="1">DE = 0xFFE0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acf0"></span>ACF0</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &lt; 32) DE = 0xF8E0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acf1"></span>ACF1</td>
<td class="instruction">CP $20</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acf3"></span>ACF3</td>
<td class="instruction">JR NC,$ACF8</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acf5"></span>ACF5</td>
<td class="instruction">LD DE,$F8E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="acf8"></span>ACF8</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acf9"></span>ACF9</td>
<td class="instruction">DJNZ $ACE8</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="acfb"></span>ACFB</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1">return;</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="ABF9.html">ABF9</a></span></td>
<td class="up">Up: <a href="../maps/all.html#ac6f">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="ACFC.html">ACFC</a></span></td>
</tr>
</table>
<footer>
<div class="release">The incomplete The Great Escape disassembly 20170325</div>
<div class="copyright">&copy; Denton Designs. Ocean. David Thomas.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 5.4.</div>
</footer>
</body>
</html>