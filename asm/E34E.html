<!DOCTYPE html>
<html>
<head>
<title>The Great Escape: Routine at E34E</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../TheGreatEscape.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="The Great Escape" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="E2AC.html">E2AC</a></span></td>
<td class="up">Up: <a href="../maps/all.html#e34e">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="E3FA.html">E3FA</a></span></td>
</tr>
</table>
<div class="description">E34E: Sprite plotter "right" case.</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="E2A2.html">masked_sprite_plotter_16_wide_vischar</a>.
</div>
<div class="paragraph">
Counterpart of above routine.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_right</td>
<td class="address-2"><span id="e34e"></span>E34E</td>
<td class="instruction">SUB $04</td>
<td class="comment-11" rowspan="5">A = (A - 4) * 6; // jump table offset</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e350"></span>E350</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e351"></span>E351</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e352"></span>E352</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e353"></span>E353</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e354"></span>E354</td>
<td class="instruction">LD ($E39A),A</td>
<td class="comment-11" rowspan="1">($E399 + 1) = A; // self-modify - first jump</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e357"></span>E357</td>
<td class="instruction">LD ($E37D),A</td>
<td class="comment-11" rowspan="1">($E37C + 1) = A; // self-modify - second jump</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e35a"></span>E35A</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="2">maskptr = mask_pointer;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e35b"></span>E35B</td>
<td class="instruction">LD HL,($81AE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e35e"></span>E35E</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="2">bitmapptr = bitmap_pointer;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e35f"></span>E35F</td>
<td class="instruction">LD HL,($81AC)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_height_iters</td>
<td class="address-1"><span id="e362"></span>E362</td>
<td class="instruction">LD B,$20</td>
<td class="comment-11" rowspan="1">B = 32; // iterations // height? // self modified</td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_right_0</td>
<td class="address-2"><span id="e364"></span>E364</td>
<td class="instruction">LD D,(HL)</td>
<td class="comment-11" rowspan="2">do &lt;% bm1 = *bitmapptr++; // numbering of the masks ... unsure</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e365"></span>E365</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e366"></span>E366</td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-11" rowspan="2">bm2 = *bitmapptr++;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e367"></span>E367</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e368"></span>E368</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="4">mask1 = *maskptr++;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e369"></span>E369</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36a"></span>E36A</td>
<td class="instruction">LD D,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36b"></span>E36B</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36c"></span>E36C</td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-11" rowspan="2">mask2 = *maskptr++;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36d"></span>E36D</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36e"></span>E36E</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="4">if (flip_sprite &amp; (1&lt;&lt;7)) flip_16_masked_pixels();</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e36f"></span>E36F</td>
<td class="instruction">LD A,($81B7)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e372"></span>E372</td>
<td class="instruction">AND A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e373"></span>E373</td>
<td class="instruction">CALL M,<a href="E40F.html">flip_16_masked_pixels</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e376"></span>E376</td>
<td class="instruction">LD HL,($81B0)</td>
<td class="comment-11" rowspan="1">foremaskptr = foreground_mask_pointer;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="e379"></span>
<div class="comments">
<div class="paragraph">
Shift mask.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e379"></span>E379</td>
<td class="instruction">LD C,$FF</td>
<td class="comment-11" rowspan="1">mask0 = 0xFF; // all bits set =&gt; mask OFF (that would match the observed stored mask format)</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e37b"></span>E37B</td>
<td class="instruction">SCF</td>
<td class="comment-11" rowspan="1">carry = 1; // mask OFF</td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_jump0</td>
<td class="address-1"><span id="e37c"></span>E37C</td>
<td class="instruction">JR <a href="E34E.html#e37e">masked_sprite_plotter_16_wide_right_1</a></td>
<td class="comment-11" rowspan="1">goto $E37E; // self modified // jump table</td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_right_1</td>
<td class="address-2"><span id="e37e"></span>E37E</td>
<td class="instruction">RL E</td>
<td class="comment-11" rowspan="1">RL mask2 // 0 // new_carry = mask2 &gt;&gt; 7; mask2 = (mask2 &lt;&lt; 1) | (carry &lt;&lt; 0); carry = new_carry;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e380"></span>E380</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL mask1      // new_carry = mask1 &gt;&gt; 7; mask1 = (mask1 &lt;&lt; 1) | (carry &lt;&lt; 0); carry = new_carry;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e382"></span>E382</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL mask0      // new_carry = mask0 &gt;&gt; 7; mask0 = (mask0 &lt;&lt; 1) | (carry &lt;&lt; 0); carry = new_carry;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e384"></span>E384</td>
<td class="instruction">RL E</td>
<td class="comment-11" rowspan="1">RL mask2 // 1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e386"></span>E386</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL mask1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e388"></span>E388</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL mask0</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e38a"></span>E38A</td>
<td class="instruction">RL E</td>
<td class="comment-11" rowspan="1">RL mask2 // 2</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e38c"></span>E38C</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL mask1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e38e"></span>E38E</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL mask0</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e390"></span>E390</td>
<td class="instruction">RL E</td>
<td class="comment-11" rowspan="1">RL mask2 // 3 // four groups of shifting in this routine, compared to three above.</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e392"></span>E392</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL mask1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e394"></span>E394</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL mask0</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="e396"></span>
<div class="comments">
<div class="paragraph">
Shift bitmap.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e396"></span>E396</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="3">bm0 = 0; // all bits clear =&gt; pixels OFF</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e397"></span>E397</td>
<td class="instruction">XOR A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e398"></span>E398</td>
<td class="instruction">LD C,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_jump1</td>
<td class="address-1"><span id="e399"></span>E399</td>
<td class="instruction">JR <a href="E34E.html#e39b">masked_sprite_plotter_16_wide_right_2</a></td>
<td class="comment-11" rowspan="1">goto $E39B; // self modified // jump table</td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_right_2</td>
<td class="address-2"><span id="e39b"></span>E39B</td>
<td class="instruction">SLA E</td>
<td class="comment-11" rowspan="1">SLA bm2 // 0 // carry = bm2 &gt;&gt; 7; bm2 &lt;&lt;= 1;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e39d"></span>E39D</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL bm1       // new_carry = bm1 &gt;&gt; 7; bm1 = (bm1 &lt;&lt; 1) | (carry &lt;&lt; 0); carry = new_carry;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e39f"></span>E39F</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL bm0       // new_carry = bm0 &gt;&gt; 7; bm0 = (bm0 &lt;&lt; 1) | (carry &lt;&lt; 0); carry = new_carry;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3a1"></span>E3A1</td>
<td class="instruction">SLA E</td>
<td class="comment-11" rowspan="1">SLA bm2</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3a3"></span>E3A3</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL bm1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3a5"></span>E3A5</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL bm0</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3a7"></span>E3A7</td>
<td class="instruction">SLA E</td>
<td class="comment-11" rowspan="1">SLA bm2</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3a9"></span>E3A9</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL bm1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ab"></span>E3AB</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL bm0</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ad"></span>E3AD</td>
<td class="instruction">SLA E</td>
<td class="comment-11" rowspan="1">SLA bm2</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3af"></span>E3AF</td>
<td class="instruction">RL D</td>
<td class="comment-11" rowspan="1">RL bm1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b1"></span>E3B1</td>
<td class="instruction">RL C</td>
<td class="comment-11" rowspan="1">RL bm0</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="e3b3"></span>
<div class="comments">
<div class="paragraph">
Plot, using foreground mask.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b3"></span>E3B3</td>
<td class="instruction">LD HL,($81A2)</td>
<td class="comment-11" rowspan="1">screenptr = ($81A2);</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b6"></span>E3B6</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="13">A = ((~*foremaskptr | mask0) &amp; *screenptr) | (bm0 &amp; *foremaskptr);</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b7"></span>E3B7</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b8"></span>E3B8</td>
<td class="instruction">CPL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3b9"></span>E3B9</td>
<td class="instruction">OR C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ba"></span>E3BA</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3bb"></span>E3BB</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3bc"></span>E3BC</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3bd"></span>E3BD</td>
<td class="instruction">LD A,C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3be"></span>E3BE</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3bf"></span>E3BF</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c0"></span>E3C0</td>
<td class="instruction">LD C,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c1"></span>E3C1</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c2"></span>E3C2</td>
<td class="instruction">OR C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c3"></span>E3C3</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2">foremaskptr++;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c4"></span>E3C4</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_enable1</td>
<td class="address-1"><span id="e3c5"></span>E3C5</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="2">*screenptr++ = A; // entry point jump1</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c6"></span>E3C6</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c7"></span>E3C7</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="13">A = ((~*foremaskptr | mask1) &amp; *screenptr) | (bm1 &amp; *foremaskptr);</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c8"></span>E3C8</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3c9"></span>E3C9</td>
<td class="instruction">CPL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ca"></span>E3CA</td>
<td class="instruction">OR D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3cb"></span>E3CB</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3cc"></span>E3CC</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3cd"></span>E3CD</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ce"></span>E3CE</td>
<td class="instruction">LD A,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3cf"></span>E3CF</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d0"></span>E3D0</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d1"></span>E3D1</td>
<td class="instruction">LD D,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d2"></span>E3D2</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d3"></span>E3D3</td>
<td class="instruction">OR D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d4"></span>E3D4</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2">foremaskptr++;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d5"></span>E3D5</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_enable3</td>
<td class="address-1"><span id="e3d6"></span>E3D6</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="2">*screenptr++ = A; // entry point jump3</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d7"></span>E3D7</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d8"></span>E3D8</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="13">A = ((~*foremaskptr | mask2) &amp; *screenptr) | (bm2 &amp; *foremaskptr);</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3d9"></span>E3D9</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3da"></span>E3DA</td>
<td class="instruction">CPL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3db"></span>E3DB</td>
<td class="instruction">OR E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3dc"></span>E3DC</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3dd"></span>E3DD</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3de"></span>E3DE</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3df"></span>E3DF</td>
<td class="instruction">LD A,E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e0"></span>E3E0</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e1"></span>E3E1</td>
<td class="instruction">AND (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e2"></span>E3E2</td>
<td class="instruction">LD E,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e3"></span>E3E3</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e4"></span>E3E4</td>
<td class="instruction">OR E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e5"></span>E3E5</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2">foremaskptr += 2;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e6"></span>E3E6</td>
<td class="instruction">INC L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3e7"></span>E3E7</td>
<td class="instruction">LD ($81B0),HL</td>
<td class="comment-11" rowspan="3">foreground_mask_pointer = foremaskptr;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ea"></span>E3EA</td>
<td class="instruction">POP HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3eb"></span>E3EB</td>
<td class="instruction">EXX</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">masked_sprite_plotter_16_wide_case_2_enable5</td>
<td class="address-1"><span id="e3ec"></span>E3EC</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">*screenptr = A; // entry point jump5</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3ed"></span>E3ED</td>
<td class="instruction">LD DE,$0016</td>
<td class="comment-11" rowspan="2">screenptr += 22; // stride (24 - 2)</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f0"></span>E3F0</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f1"></span>E3F1</td>
<td class="instruction">LD ($81A2),HL</td>
<td class="comment-11" rowspan="1">($81A2) = screenptr;</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f4"></span>E3F4</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="3">%&gt; while (--B);</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f5"></span>E3F5</td>
<td class="instruction">DEC B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f6"></span>E3F6</td>
<td class="instruction">JP NZ,<a href="E34E.html#e364">masked_sprite_plotter_16_wide_right_0</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="e3f9"></span>E3F9</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1">return;</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="E2AC.html">E2AC</a></span></td>
<td class="up">Up: <a href="../maps/all.html#e34e">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="E3FA.html">E3FA</a></span></td>
</tr>
</table>
<footer>
<div class="release">The nearly complete The Great Escape disassembly 20180825</div>
<div class="copyright">&copy; 1986 Denton Designs &amp; Ocean Software Ltd. (The Great Escape). &copy; 2012-2018 David Thomas (this disassembly).</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 6.4.</div>
</footer>
</body>
</html>